version: '3.8'

services:
  mcp-atlassian:
    image: ghcr.io/sooperset/mcp-atlassian:latest
    container_name: mcp-atlassian
    restart: unless-stopped
    ports:
      - "9000:9000"
    env_file:
      - .env
    volumes:
      # OAuth token persistence (for standard OAuth flow)
      - ./config:/home/app/.mcp-atlassian
      # Logs
      - ./logs:/var/log/mcp-atlassian
    command: --transport streamable-http --port 9000 -vv
    networks:
      - mcp-atlassian-net
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

networks:
  mcp-atlassian-net:
    driver: bridge

# Quick start:
# 1. Copy .env.example to .env and fill in your credentials
# 2. Run: docker-compose up -d
# 3. Check logs: docker-compose logs -f
# 4. Access at: http://localhost:9000/mcp
#
# For OAuth setup wizard:
# docker-compose run --rm -p 8080:8080 mcp-atlassian --oauth-setup -v
