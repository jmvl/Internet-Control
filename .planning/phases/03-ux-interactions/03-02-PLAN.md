# 03-02: Form UX Enhancements

<objective>
Enhance form user experience with character counter, inline validation improvements, and better error/success state design.
</objective>

<context>
@websites/www.dinero.cash/index.html
@websites/www.dinero.cash/contact-us.html
@websites/www.dinero.cash/assets/css/accessibility-improvements.css
@websites/www.dinero.cash/assets/js/form-validation.js
@.planning/STATE.md
</context>

<tasks>
<task name="Add character counter to textarea fields">
1. Open `contact-us.html`
2. Find the textarea field (Your Question)
3. Add character counter HTML below textarea:
   ```html
   <div class="character-counter">
     <span id="question-counter">0</span> / 5000 characters
   </div>
   ```
4. Add CSS for counter styling in `accessibility-improvements.css`:
   ```css
   .character-counter {
     font-size: 0.75rem;
     color: #757575;
     text-align: right;
     margin-top: 4px;
   }

   .character-counter.warning {
     color: #FFA000;
   }

   .character-counter.error {
     color: #D32F2F;
     font-weight: 600;
   }
   ```
5. Add JavaScript to update counter:
   ```javascript
   // Add to form-validation.js
   $('#Your-Question').on('input', function() {
     const current = $(this).val().length;
     const max = 5000;
     const $counter = $('#question-counter');

     $counter.text(current);

     if (current > max * 0.9) {
       $counter.parent().addClass('warning');
     } else if (current >= max) {
       $counter.parent().addClass('error');
     } else {
       $counter.parent().removeClass('warning error');
     }
   });
   ```
6. Test counter updates as user types
7. Save files
</task>

<task name="Improve error message design and placement">
1. Open `accessibility-improvements.css`
2. Enhance error message styling:
   ```css
   .error-message {
     display: none;
     color: #D32F2F;
     font-size: 0.875rem;
     margin-top: 6px;
     padding: 8px 12px;
     background-color: #FFEBEE;
     border-left: 3px solid #D32F2F;
     border-radius: 4px;
   }

   .error-message.visible {
     display: block;
     animation: slide-in 0.2s ease-out;
   }

   @keyframes slide-in {
     from {
       opacity: 0;
       transform: translateY(-5px);
     }
     to {
       opacity: 1;
       transform: translateY(0);
     }
   }

   input.invalid,
   textarea.invalid {
     border: 2px solid #D32F2F;
     background-color: #FFEBEE;
   }

   input.valid,
   textarea.valid {
     border: 2px solid #00C853;
   }

   /* Add success indicator */
   .field-success-indicator {
     display: none;
     position: absolute;
     right: 12px;
     top: 50%;
     transform: translateY(-50%);
     color: #00C853;
   }

   .text-field.valid ~ .field-success-indicator {
     display: block;
   }
   ```
3. Save file
4. Update form HTML to include success indicators
</task>

<task name="Add success state feedback after form submission">
1. Open `index.html` and find success message div
2. Enhance success message styling:
   ```css
   .success-message {
     display: none;
     padding: 16px;
     background-color: #E8F5E9;
     border: 2px solid #00C853;
     border-radius: 8px;
     color: #1B5E20;
     text-align: center;
   }

   .success-message.show {
     display: block;
     animation: success-pop 0.3s ease-out;
   }

   @keyframes success-pop {
     0% { transform: scale(0.9); opacity: 0; }
     50% { transform: scale(1.02); }
     100% { transform: scale(1); opacity: 1; }
   }

   /* Add checkmark icon */
   .success-message::before {
     content: '✓';
     display: block;
     font-size: 2rem;
     margin-bottom: 8px;
   }
   ```
3. Add to accessibility-improvements.css
4. Update form success message HTML to use new styling
5. Save files
</task>

<task name="Add inline validation with debouncing">
1. Open `form-validation.js`
2. Enhance validation with debouncing to avoid validation on every keystroke:
   ```javascript
   // Add debouncing function
   function debounce(func, wait) {
     let timeout;
     return function executedFunction(...args) {
       const later = () => {
         clearTimeout(timeout);
         func(...args);
       };
       clearTimeout(timeout);
       timeout = setTimeout(later, wait);
     };
   }

   // Debounced validation for text inputs
   const debouncedValidation = debounce(function($input) {
     const errorId = $input.attr('id') + '-error';
     const $error = $('#' + errorId);

     if ($input[0].checkValidity()) {
       $input.removeClass('invalid').addClass('valid');
       $input.attr('aria-invalid', 'false');
       $error.removeClass('visible').text('');
     } else {
       $input.removeClass('valid').addClass('invalid');
       $input.attr('aria-invalid', 'true');
       $error.text($input[0].validationMessage).addClass('visible');
     }
   }, 300);

   // Apply debounced validation on input
   $('input[type="text"], input[type="email"], textarea').on('input', function() {
     const $input = $(this);
     if ($input.val().length > 0) {
       debouncedValidation($input);
     }
   });
   ```
3. Save file
4. Test validation behavior:
   - Type in field → validation waits until user stops typing
   - See error appear after 300ms of no typing
   - See error clear immediately when corrected
</task>

<task name="Test complete form flow">
1. Open index.html in browser
2. Test demo form flow:
   - Click in name field, leave empty → error shows
   - Type invalid email → error shows
   - Fix all errors → submit button enabled
   - Submit form → success message shows
3. Test with keyboard:
   - Tab through fields
   - Verify error messages read by screen reader
   - Verify ARIA states update correctly
4. Test on mobile:
   - Tap targets are large enough (44x44px min)
   - Validation works on mobile keyboards
   - Success message displays correctly on small screen
5. Repeat for contact-us.html
6. Document any issues found
</task>
</tasks>

<success>
- [ ] Character counter added to textarea (shows X / 5000)
- [ ] Counter changes color at 90% (warning) and 100% (error)
- [ ] Error messages have improved design (red border, background, icon)
- [ ] Success indicators show green checkmark for valid fields
- [ ] Success message has animation and checkmark icon
- [ ] Validation debounced (300ms) to avoid annoying user
- [ ] Validation triggers on blur and after debounced input
- [ ] Complete form flow tested (errors → submit → success)
- [ ] Keyboard navigation works correctly
- [ ] Screen reader announces errors correctly
- [ ] Mobile experience tested and working
</success>
